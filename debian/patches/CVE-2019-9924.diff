Origin: https://git.savannah.gnu.org/cgit/bash.git/diff/?h=bash-4.4-testing&id=a4eef1991c25c9d1c55f777952cd522c762c6fc3&id2=690150f9e5e860a4211e71ef4446938bb57ee983

variables.c
	- assign_hashcmd: if the shell is restricted, reject attempts to add
	  pathnames containing slashes to the hash table, as the hash builtin
	  does.  Fixes bug reported to savannah by Sylvain Beucler as
	  https://savannah.gnu.org/support/?108969

--- a/variables.c
+++ b/variables.c
@@ -1601,6 +1601,13 @@
      arrayind_t ind;
      char *key;
 {
+#if defined (RESTRICTED_SHELL)
+  if (restricted && strchr (value, '/'))
+    {
+      sh_restricted (value);
+      return (SHELL_VAR *)NULL;
+    }
+#endif
   phash_insert (key, value, 0, 0);
   return (build_hashcmd (self));
 }
